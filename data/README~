*****************************************************************
*--  Summary of data sets                                     --*
*--                                                           --*
*--  'New estimators for conditional false discovery rates    --*
*--    improve power and smoothness'                          --*
*--                                                           --*
*--  James Liley and Chris Wallace                            --*
*--  2018                                                     --*
*****************************************************************

This folder contains three .RData files and two .dat files

cfdrsimmatrix.RData: a matrix of simulation results
cfdrsimmatrix_low_alpha.RData: a matrix of simulation results at
  alpha=0.01 instead of 0.1
twas_summary.RData: R objects relating to cFDR analysis of TWAS
  data.


These two files were sourced from http://twas-hub.org, and further
 information on them can be found there.
BCAC.dat: table of results from TWAS analysis of breast cancer. 
OCAC.dat: table of results from TWAS analysis of ovarian cancer. 


The file twas_summary.RData is generated by the script in 

../code/analysis_estimation.R

The objects in these files are summarised below.



### cfdrsimmatrix.RData ###

This file contains a single object called rx. This is a data
frame with the following columns. Some columns are only 
relevant to our second paper, 'New estimators for conditional
false discovery rates improve power and smoothness', but their
explanation is included here for completeness. Variables are 
explained in the supplementary material, section 'Simulation 
protocol'. Simulations are oversampled with n1p+n1pq=0.

[1] seed: random seed used to generate the simulation. To 
  reproduce the results of a given run of the simulation, run
  the script ../code/run_simulation.R with the variable 'seed'
  set to this value.
[2] alpha: FDR control level. Always 0.1 for this data
[3] N: number of variables
[4] dist1: TRUE effect size distribution for non-null effects.
  1 corresponds to normal, 2 to t (3df), 3 to Cauchy.
[5] dist2: ASSUMED effect size distribution for modelling 
  Z_Q|HP0 and integrating over L. Always 1 (normal).
[6] n1p: number of variables associated with P
[7] n1q: number of variables associated with Q
[8] n1pq: number of variables associated with P and Q
[9] sp: scale of effect size distribution for variables 
  associated with P
[10] sq: scale of effect size distribution for variables 
  associated with Q
[11-17] fit_{x}: parameters of bivariate Gaussian-mixture 
  model for distribution of P,Q. Only relevant to second 
  paper. {x} can be in {pi0,pi1,pi2,tau1,tau2,sigma1,sigma2}.
[18] fit_conv: indicator for convergence of mixture-Gaussian 
  model. Only relevant for paper 2.
[19-20] {x}_null: parameters of bivariate Gaussian fitted to 
  distribution of Q|P>0.5. {x} can be in {pi0,sigma}.
[21-214] {A}_cf{B}_fdr{C}_adj{D}_dist{E}_fold{F}: results 
  from simulations. 
  {A}: either fdp or tdr
  {B}: 1,2, or 3: type of cfdr estimator. Paper 1 only uses B=1.
    Other estimators are relevant to paper 2.
  {C}: 1,2,3,3b, or 4: type of FDR control method. Method 4 
    (leave-one-out) is deprecated for B=2/3, but C=4 is used to
    code for 'local' fdp/t2r control using method 3b for B=2.
  {D}: 0 or 1: include estimate of Pr(Q<q|HP0) in estimator of
    cFDR. Only relevant for paper 2.
  {E}: 1 or 2: distribution of P,Q|HP0 used for integration 
    over L-regions. 1 indicates the true distribution, 2 the
    estimated distribution parametrised by pi0_null,sigma_null,
    dist2.
  {F}: 1,2, or 3: fold, only relevant if C=3. Corresponds to
    within-fold FDP/T2R
  Also contains fdp_p (column 21) and t2r_p (column 118) 
    corresponding to FDP and T2R of the Benjamini-Hochberg 
    method applied to p-values.



### cfdrsimmatrix_low_alpha.RData ###

This file contains a single object called rx_low_alpha. This is
identical to the object rx in cfdrsimmatrix.RData but uses an 
FDR control level of alpha=0.01 instead of 0.1. Since these 
simulations are only used for comparison of type 2 error rate 
between methods, only simulations drawing parameters from 
continuous distributions are included. Each row of the simulation
can be reproduced from the random seed by replacing both 
occurrences of 'alpha=0.1' with 'alpha=0.01 in 
../code/run_simulation.



### twas_summary.RData ###

This file contains 25 objects. 

p_brca: p-values for BRCA cases vs controls
p_oca: p-vales for OCA cases vs controls
fold: index of folds for each hypothesis. Each tissue correpsonds
 to a different fold
sub_brca: indices of 'interesting' hypotheses for BRCA|OCA (potential
 hits) to thin down dataset
sub_oca: indices of 'interesting' hypotheses for OCA|BRCA (potential
 hits) to thin down dataset
chr: chromosomes of genes corresponding to p_brca/p_oca
pos: approximate positions of genes corresponding to p_brca/p_oca
gene: gene names corresponding to p_brca/p_oca
tissue: tissues corresponding to p_brca/p_oca
xbrca1: x co-ordinates of L-regions for adjusted cFDR analysis (cFDR1)
 of BRCA|OCA
xbrca2: x co-ordinates of L-regions for unadjusted cFDR analysis 
 (cFDR1s) of BRCA|OCA
xoca1: x co-ordinates of L-regions for adjusted cFDR analysis (cFDR1)
 of OCA|BRCA
xoca2: x co-ordinates of L-regions for unadjusted cFDR analysis 
 (cFDR1s) of OCA|BRCA
ybrca1: y co-ordinates of L-regions for adjusted cFDR analysis (cFDR1)
 of BRCA|OCA
ybrca2: y co-ordinates of L-regions for unadjusted cFDR analysis 
 (cFDR1s) of BRCA|OCA
yoca1: y co-ordinates of L-regions for adjusted cFDR analysis (cFDR1)
 of OCA|BRCA
yoca2: y co-ordinates of L-regions for unadjusted cFDR analysis 
 (cFDR1s) of OCA|BRCA
pi0_brca, sigma_brca: parameters of distribution for z_oca|p_brca >0.5
pi0_oca, sigma_oca: parameters of distribution for z_brca|p_oca >0.5
i_brca1: integrals over L-regions using adjusted cFDR (cFDR1) for 
 BRCA|OCA
i_brca2: integrals over L-regions using unadjusted cFDR (cFDR1s) for 
 BRCA|OCA
i_oca1: integrals over L-regions using adjusted cFDR (cFDR1) for 
 OCA|BRCA
i_oca2: integrals over L-regions using unadjusted cFDR (cFDR1s) for 
 OCA|BRCA

